import mxnet as mx
import numpy as np
from mxnet import image
from mxnet import nd

augs = image.CreateAugmenter(data_shape=(3, 224, 224), rand_mirror=True, rand_crop=True, rand_resize=False,
                             brightness=0.125, contrast=0.125, saturation=0.125)
augs_val = image.CreateAugmenter(data_shape=(3, 224, 224), rand_crop=True,rand_mirror=True)
#augs_val = augs
cropaug = mx.image.RandomSizedCropAug(size=(224, 224), min_area=0.5, ratio=[0.75, 1.33333])
resize_short_aug = mx.image.ResizeAug(size=224)
augs.insert(0, resize_short_aug)
augs_val.insert(0, resize_short_aug)


def transform(data, label):
    for aug in augs:
        data = aug(data)
    return nd.transpose(mx.image.color_normalize(data.astype(np.float32) / 255,
                                                 mean=mx.nd.array([0.485, 0.456, 0.406]),
                                                 std=mx.nd.array([0.229, 0.224, 0.225])), (2, 0, 1)), label


def transform_val(data, label):
    for aug in augs_val:
        data = aug(data)
    return nd.transpose(mx.image.color_normalize(data.astype(np.float32) / 255,
                                                 mean=mx.nd.array([0.485, 0.456, 0.406]),
                                                 std=mx.nd.array([0.229, 0.224, 0.225])), (2, 0, 1)), label
def transform_histgram(data, label):
    #return data,label
    data = mx.image.CenterCropAug((112,112))(data)
    return data,label

if __name__ == '__main__':
    for i in augs:
        print(i.dumps())
